# 采购单管理系统 - UI交互原型说明书

## 一、页面总体布局

### 布局架构（由上到下）

```
┌────────────────────────────────────────────────┐
│          顶部导航栏 (Header Bar)                │
│  ← 返回 | 采购计划 | 采购单 ∨ | ⏱ | 🔔 📢   │
└────────────────────────────────────────────────┘
                    ↓
┌────────────────────────────────────────────────┐
│       日期时间范围选择器 (Date Selector)       │
│  📅 12月12日~01月12日              ↓          │
└────────────────────────────────────────────────┘
                    ↓
┌────────────────────────────────────────────────┐
│                                                 │
│           采购单列表容器 (Order List)           │
│                                                 │
│  ┌────────────────────────────────────────┐   │
│  │      采购单卡片 #1 (Order Card)        │   │
│  │  • 订单基本信息                         │   │
│  │  • 采购项目表格                         │   │
│  │  • 统计信息                             │   │
│  └────────────────────────────────────────┘   │
│                                                 │
│  ┌────────────────────────────────────────┐   │
│  │      采购单卡片 #2 (Order Card)        │   │
│  │  • 订单基本信息                         │   │
│  │  • 采购项目表格                         │   │
│  │  • 统计信息                             │   │
│  └────────────────────────────────────────┘   │
│                                                 │
│  [更多卡片...]                                 │
│                                                 │
└────────────────────────────────────────────────┘
                    ↓
┌────────────────────────────────────────────────┐
│        汇总统计区域 (Summary Section)          │
│  • 总单数、总数量、毛重、净重                  │
│  • 押金、总货款等关键指标                      │
└────────────────────────────────────────────────┘
                    ↓
┌────────────────────────────────────────────────┐
│           操作按钮区域 (Action Bar)            │
│      [+ 新建采购单]                            │
└────────────────────────────────────────────────┘
```

---

## 二、各模块详细说明

### 1. 顶部导航栏 (Header)

#### 结构

```
┌─────────────────────────────────────────────────┐
│ < │ 采购计划  │ 采购单 ▼ │    ⏱    │    🔔    │
└─────────────────────────────────────────────────┘
  ↑      ↑         ↑         ↑        ↑
  返回  标签页   当前页   时间选择  通知中心
```

#### 各按钮功能说明

| 位置 | 图标 | 功能 | 点击效果 | 响应 |
|------|------|------|---------|------|
| 最左 | `<` | 返回上一级 | 返回列表 | 返回 list 页面 |
| 左二 | 采购计划 | 切换视图 | 展示计划视图 | 切换到计划标签页 |
| 中 | 采购单 ∨ | 当前页 + 下拉 | 打开下拉菜单 | 展示更多选项 |
| 右二 | ⏱ | 日期筛选 | 展开日期选择器 | 打开日期 picker |
| 最右 | 🔔 | 消息通知 | 打开通知 | 显示通知列表 |

#### 样式规范

- **背景**: 白色 (#FFFFFF)
- **高度**: 44px / 56px (按设备)
- **边框**: 下边界灰色 1px (#EEEEEE)
- **文字颜色**: 深灰色 (#333333)
- **字体大小**: 16px (标签), 14px (副文本)

---

### 2. 日期时间范围选择器 (Date Selector)

#### 显示区域

```
┌────────────────────────────┐
│ 📅 12月12日~01月12日   ↓  │
└────────────────────────────┘
```

#### 交互说明

| 交互 | 触发条件 | 显示内容 | 效果 |
|------|---------|---------|------|
| 点击选择器 | 用户点击时间区域 | 日期选择弹窗 | 弹出日期 picker |
| 选择日期 | 在 picker 中选择 | 日期范围更新 | 列表自动刷新 |
| 清除选择 | 点击清除按钮 | 重置为默认 | 显示全部数据 |
| 快速选项 | 点击预设选项 | 快速选择 | 最近30天/90天等 |

#### 日期选择弹窗 (Date Picker Dialog)

```
┌────────────────────────────┐
│    选择日期范围            │
├────────────────────────────┤
│ 开始日期: [选择日期] ✓     │
│ 结束日期: [选择日期] ✓     │
├────────────────────────────┤
│ 快速选择:                  │
│  [最近7天] [最近30天]     │
│  [最近90天] [本月]         │
│  [本年] [自定义]           │
├────────────────────────────┤
│    [取消]  [确认查询]      │
└────────────────────────────┘
```

---

### 3. 采购单卡片 (Order Card)

#### 卡片整体结构

```
┌─────────────────────────────────────────────┐
│ 📅 2026年01月09日         [编辑] [删除]      │  ← 卡片头
├─────────────────────────────────────────────┤
│ 农户: 测试原因1增改24                        │  ← 农户信息
│ 采购员: 老王                                 │
├─────────────────────────────────────────────┤
│ 采购项目 Table:                             │  ← 项目表格
│ ┌─────────────────────────────────────────┤
│ │ 规格 | 采购量 | 单价 | 金额 | 操作       │
│ ├─────────────────────────────────────────┤
│ │ 西瓜... │ 5斤/22kg │ 1 │ 22 │ [编辑]   │
│ │ (应价: 20)                               │
│ ├─────────────────────────────────────────┤
│ │ 编码(ID): 33666                          │
│ │ 应价(价): 333 | 应价(ID): 88            │
│ └─────────────────────────────────────────┘
├─────────────────────────────────────────────┤
│ 农户: 测试原因1增改24                        │
│ 采购员: 老王                                 │
│                                              │
│ 采购项目 Table:                              │
│ ┌─────────────────────────────────────────┤
│ │ 规格 | 采购量 | 单价 | 金额 | 操作       │
│ ├─────────────────────────────────────────┤
│ │ 西瓜... │ 2斤/5kg │ 1 │ 5 │ [编辑]     │
│ │ 编码(ID): 33666 | 应价(价): 333         │
│ │ 应价(ID): 88                             │
│ └─────────────────────────────────────────┘
└─────────────────────────────────────────────┘
```

#### 卡片组成部分详解

##### 3.1 卡片头 (Card Header)

```
┌───────────────────────────────────────────┐
│ 📅 2026年01月09日         [编辑] [删除]    │
└───────────────────────────────────────────┘
```

- **左侧**: 日期标签 + 日期值
- **右侧**: 操作按钮 (编辑/删除)
- **样式**: 灰色背景 (#F5F5F5), padding 12px

##### 3.2 订单信息区 (Order Info Section)

```
农户: 测试原因1增改24
采购员: 老王
```

- **字体**: 14px 常规
- **间距**: 8px 行距
- **颜色**: 正文色 (#333333)

##### 3.3 采购项目表格 (Purchase Items Table)

**表格结构**:
```
┌───────┬──────────┬──────┬──────┬──────┐
│ 规格   │ 采购量    │ 单价 │ 金额 │ 操作 │
├───────┼──────────┼──────┼──────┼──────┤
│ 西瓜   │ 5斤/22kg │  1   │  22  │ 编辑 │
│ (超长)│        │      │      │      │
└───────┴──────────┴──────┴──────┴──────┘
```

**表格列说明**:

| 列名 | 宽度 | 内容 | 说明 |
|------|------|------|------|
| 规格 | 40% | 产品名称 | 支持超长省略 (...) |
| 采购量 | 20% | 数量+单位 | 格式: 数值单位/重量 |
| 单价 | 15% | 价格 | 数字右对齐 |
| 金额 | 15% | 合计 | 数字右对齐 |
| 操作 | 10% | 按钮 | 编辑/删除按钮 |

**表格样式**:
- 表头背景: #F0F0F0
- 表头文字: #666666, 12px 加粗
- 行高: 40px
- 边框: 1px #EEEEEE
- 悬停效果: 背景变为 #F9F9F9

##### 3.4 核心数据行 (Key Info Row)

```
应价提示: 采购单应价: 20
编码信息: 采购单编码(ID): 33666
价格信息: 采购单应价(价): 333; 采购单应价(ID): 88
```

- **显示位置**: 每个采购项目下方
- **字体**: 12px 灰色 (#999999)
- **间距**: 上边距 4px

---

### 4. 汇总统计区域 (Summary Section)

#### 布局

```
┌─────────────────────────────────────────────┐
│ 汇计    共120单、数量:1006413.1、             │
│  毛: 1121734.45kg、净: 1015168.94kg          │
│  押金: 388005011.1、                        │
│  总货款: 9000001766226.1                    │
└─────────────────────────────────────────────┘
```

#### 统计项目清单

| 指标 | 英文 | 值 | 单位 | 说明 |
|------|------|-----|------|------|
| 单数 | order_count | 120 | 单 | 采购单总数量 |
| 数量 | total_quantity | 1006413.1 | 件 | 购买数量总和 |
| 毛重 | gross_weight | 1121734.45 | kg | 含包装总重 |
| 净重 | net_weight | 1015168.94 | kg | 不含包装总重 |
| 押金 | deposit | 388005011.1 | 元 | 定金总额 |
| 总货款 | total_amount | 9000001766226.1 | 元 | 应付总额 |

#### 样式规范

- **背景**: 浅黄色 (#FFFAF0) 或浅灰色 (#F5F5F5)
- **文字颜色**: 正文色 (#333333)
- **字体**: 14px 常规
- **行高**: 1.8
- **内边距**: 16px
- **外边距**: 12px 0
- **边框**: 上下各 1px #EEEEEE

---

### 5. 操作按钮区域 (Action Bar)

#### 布局

```
┌─────────────────────────────────────────────┐
│          [+ 新建采购单]                     │
└─────────────────────────────────────────────┘
```

#### 按钮说明

| 按钮 | 图标 | 功能 | 点击后 | 样式 |
|------|------|------|--------|------|
| 新建采购单 | + | 创建新订单 | 跳转表单页 | 绿色 (#66BB6A) |

#### 按钮样式规范

- **宽度**: 占据全宽 (100%)
- **高度**: 48px
- **背景色**: 主色绿色 (#66BB6A)
- **文字**: 白色, 16px 加粗
- **圆角**: 6px
- **边距**: 左右 16px, 上下 12px
- **悬停**: 背景变深 (#5AA55A)
- **按下**: 透明度 0.9

---

## 三、交互动作详细说明

### 1. 时间筛选流程

```
用户点击日期选择器
    ↓
显示日期选择弹窗
    ↓
用户选择开始日期
    ↓
用户选择结束日期
    ↓
用户点击"确认查询"
    ↓
发送 API 请求 (GET /api/purchase-orders?start_date=...&end_date=...)
    ↓
刷新采购单列表
    ↓
隐藏弹窗，显示新结果
```

### 2. 新增采购单流程

```
用户点击"+ 新建采购单"按钮
    ↓
跳转到采购单创建页面
    ↓
页面显示表单:
  - 农户名称 (必填)
  - 采购员 (必填)
  - 采购日期 (自动填充今天)
  - 采购项目 (可添加多行)
    ├─ 产品规格 (必填)
    ├─ 采购数量 (必填)
    ├─ 单价 (必填)
    └─ 备注 (可选)
    ↓
用户填写表单
    ↓
用户点击保存按钮
    ↓
验证表单数据
    ↓
发送 POST /api/purchase-orders
    ↓
成功提示
    ↓
返回列表页面，显示新创建的订单
```

### 3. 编辑采购单流程

```
用户点击卡片中的"编辑"按钮
    ↓
跳转编辑页面，加载订单详情
    ↓
显示表单 (预填充现有数据)
    ↓
用户修改数据
    ↓
用户点击保存
    ↓
验证表单
    ↓
发送 PUT /api/purchase-orders/{order_id}
    ↓
成功提示
    ↓
返回列表，更新卡片数据
```

### 4. 删除采购单流程

```
用户点击卡片中的"删除"按钮
    ↓
显示确认对话框:
  "确定要删除此采购单吗?"
  [取消] [确认删除]
    ↓
用户确认删除
    ↓
发送 DELETE /api/purchase-orders/{order_id}
    ↓
卡片从列表中移除
    ↓
显示成功提示 "删除成功"
```

---

## 四、数据流和状态管理

### 1. 页面初始化流程

```
页面加载
    ↓
初始化默认参数
  - start_date: 当前日期 - 30天
  - end_date: 当前日期
  - sort_by: "date_desc" (默认)
    ↓
发送 GET /api/purchase-orders
    ↓
获取列表数据
    ↓
渲染采购单卡片
    ↓
计算并显示汇总统计
    ↓
页面加载完成
```

### 2. 状态变量

```javascript
{
  orders: [],              // 采购单列表
  loading: false,          // 加载中
  error: null,             // 错误信息
  pagination: {            // 分页信息
    page: 1,
    limit: 20,
    total: 0
  },
  filters: {               // 筛选参数
    start_date: "",
    end_date: "",
    sort_by: "date_desc"
  },
  summary: {               // 汇总统计
    order_count: 0,
    total_quantity: 0,
    gross_weight: 0,
    net_weight: 0,
    deposit: 0,
    total_amount: 0
  }
}
```

---

## 五、错误处理和加载态

### 1. 加载状态

```
API 请求时
    ↓
显示加载动画 (Loading Spinner)
  - 位置: 列表中央
  - 提示文字: "加载中..."
    ↓
数据加载完成
    ↓
隐藏加载动画，显示数据
```

### 2. 错误处理

```
API 请求失败
    ↓
显示错误提示
  - 位置: 列表中央
  - 内容: "加载失败，请检查网络连接"
  - 按钮: [重试]
    ↓
用户点击重试
    ↓
重新发送请求
```

### 3. 空状态

```
列表数据为空
    ↓
显示空态提示
  - 图标: 空箱子
  - 文字: "暂无采购单"
  - 按钮: [+ 新建采购单]
```

---

## 六、响应式设计细节

### 1. 移动端 (< 480px)

**列表视图调整**:
- 卡片宽度: 100%
- 表格改为卡片视图:
  ```
  规格: 西瓜
  采购量: 5斤/22kg
  单价: 1
  金额: 22
  ```
- 隐藏部分列
- 按钮全宽显示

**表格优化**:
- 采用纵向堆叠
- 使用 label: value 格式
- 删除不重要列

### 2 平板端 (768px ~ 1024px)

- 卡片宽度: 100%
- 显示完整表格
- 两列布局可选

### 3. 桌面端 (> 1024px)

- 卡片宽度: 90% 居中
- 显示完整表格
- 支持多列网格布局 (可选)

---

## 七、性能优化建议

### 1. 列表加载优化

- 虚拟滚动: 只渲染可见卡片
- 分页加载: 每页 20 条
- 懒加载: 图片/附件按需加载

### 2. 缓存策略

- 列表数据缓存 5 分钟
- 详情数据缓存 10 分钟
- 支持下拉刷新强制刷新

### 3. 图片优化

- 使用 WebP 格式
- 图片压缩和延迟加载
- CDN 加速

---

## 八、无障碍设计 (Accessibility)

### 1. 键盘导航

- Tab 键循环聚焦所有交互元素
- Enter 键激活按钮
- Esc 键关闭对话框

### 2. 屏幕阅读器支持

- 所有按钮添加 aria-label
- 表格添加表头关联
- 表单标签关联 input

### 3. 色彩对比度

- 正文: 4.5:1 或更高
- 按钮: 4.5:1 或更高
- 图标: 3:1 或更高

---

## 九、测试用例

### 功能测试

| 用例 | 步骤 | 期望结果 |
|------|------|---------|
| 加载列表 | 进入页面 | 显示采购单列表 |
| 筛选日期 | 选择日期范围 | 列表更新，只显示该范围数据 |
| 新增订单 | 点击新增，填表，保存 | 新订单出现在列表顶部 |
| 编辑订单 | 点击编辑，修改，保存 | 卡片数据更新 |
| 删除订单 | 点击删除，确认 | 订单从列表移除 |

### 性能测试

| 指标 | 目标 | 测试方法 |
|------|------|---------|
| 首屏加载 | < 2s | Lighthouse |
| 列表滚动 | 60fps | DevTools Performance |
| 表格渲染 | < 100ms | 1000 条记录 |

---

## 十、产品线上体验清单

- [ ] 页面加载速度优化
- [ ] 移动端响应式适配
- [ ] 错误提示文案友好
- [ ] 加载动画平滑
- [ ] 按钮反馈及时
- [ ] 数据准确性验证
- [ ] 兼容性测试完成
- [ ] 无障碍测试完成
- [ ] 安全性审核
- [ ] 性能监控上线

---

**文档版本**: 1.0  
**更新日期**: 2026年01月12日  
**设计团队**: 产品设计部门
